:root{--bg:#f8f9fa;--card:#ffffff;--text:#212529;--muted:#6c757d;--accent:#0066cc;--danger:#dc3545;--border:#dee2e6;--shadow:rgba(0,0,0,.08);--hover:#f0f4f8}*{box-sizing:border-box}html,body{min-height:100%}body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Hiragino Kaku Gothic ProN,Noto Sans JP,Yu Gothic UI,Meiryo,sans-serif}.container{width:min(1100px,92%);margin-inline:auto}header{padding:32px 0 12px}h1{margin:0 0 8px;font-size:32px;font-weight:700;color:var(--text)}.subtitle{margin:0;color:var(--muted);font-size:16px;line-height:1.5}.grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;box-shadow:0 4px 12px var(--shadow)}h2{margin:0 0 16px;font-size:20px;font-weight:600;color:var(--text)}h3{margin:16px 0 8px;font-size:18px;font-weight:600;color:var(--text)}p{line-height:1.6;color:var(--text);margin:12px 0}ul{line-height:1.8;color:var(--text)}code{background:#e9ecef;padding:2px 6px;border-radius:4px;font-size:14px;color:#d63384}.attacker-area,.victim-area{position:relative;min-height:160px;border:2px dashed var(--border);border-radius:8px;padding:20px;margin:16px 0;background:var(--hover)}.btn{appearance:none;border:1px solid var(--border);background:var(--accent);color:#fff;padding:12px 20px;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s ease;font-size:15px}.btn:hover{background:#0052a3;transform:translateY(-1px);box-shadow:0 4px 8px var(--shadow)}.btn.danger{background:var(--danger);border-color:var(--danger);color:#fff}.btn.danger:hover{background:#c82333;transform:translateY(-1px);box-shadow:0 4px 8px #dc35454d}#invisible-overlay{position:absolute;top:24px;left:24px;width:220px;height:44px;opacity:0;background:red;border:none;cursor:pointer;pointer-events:none;z-index:10}.controls{margin:16px 0}.controls h3{margin:0 0 12px;font-size:16px;font-weight:600;color:var(--text)}.toggle{display:flex;gap:10px;align-items:center;color:var(--text);font-size:15px;margin:8px 0}.toggle input[type=checkbox],.toggle input[type=radio]{width:18px;height:18px;cursor:pointer}.note{color:var(--muted);font-size:14px;line-height:1.6;margin-top:16px}.log{min-height:80px;background:#f8f9fa;border:1px solid var(--border);border-radius:8px;padding:16px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:14px;color:var(--text);line-height:1.5}.frame-wrap{margin-top:10px;border:1px dashed var(--border);border-radius:12px;overflow:hidden}.frame-header{padding:10px 16px;background:#e9ecef;color:var(--text);font-size:14px;font-weight:500}.frame-body{padding:14px}.hidden{display:none}details.card summary{font-size:16px;font-weight:600;padding:8px 0;cursor:pointer;color:var(--text)}details.card summary:hover{color:var(--accent)}details.card .content{padding-top:16px}footer{margin-top:24px;padding:24px 0 32px}.footer{width:min(1100px,92%);margin-inline:auto;text-align:center;color:var(--muted)}.footer a{color:var(--accent);text-decoration:none;font-weight:500}.footer a:hover{text-decoration:underline}.tabs{display:flex;gap:8px;margin-bottom:0;border-bottom:none;background:transparent;padding:0;position:relative}.tabs:after{content:"";position:absolute;bottom:0;left:0;right:0;height:2px;background:var(--border);z-index:0}.tab-button{flex:1;padding:16px 24px;background:#f8f9fa;border:2px solid var(--border);border-bottom:none;border-radius:12px 12px 0 0;font-size:15px;font-weight:600;color:var(--muted);cursor:pointer;transition:all .2s ease;margin-bottom:-2px;position:relative;box-shadow:inset 0 -3px 8px #0000000d}.tab-button:not(:first-child){margin-left:4px}.tab-button:hover{color:var(--text);background:#fff;z-index:1;box-shadow:0 -2px 8px #0000000d}.tab-button.active{background:var(--card);color:var(--accent);border-color:var(--border);border-bottom:2px solid var(--card);z-index:2;box-shadow:0 -4px 12px #00000014;font-weight:700}.tab-button.active:after{content:"";position:absolute;bottom:-2px;left:0;right:0;height:2px;background:var(--card)}.tab-content{min-height:500px;background:var(--card);border:2px solid var(--border);border-top:none;border-radius:0 0 12px 12px;padding:24px;margin-top:0}.tab-panel{display:none;animation:fadeIn .3s ease}.tab-panel.active{display:block}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.info-box{background:var(--hover);border-left:4px solid var(--accent);padding:16px;margin:20px 0;border-radius:8px}.info-box h3{margin-top:0}.defense-box{background:#f8f9fa;border:1px solid var(--border);padding:20px;margin:24px 0;border-radius:8px}.code-example{margin:16px 0}.code-example pre{background:#282c34;color:#abb2bf;padding:16px;border-radius:6px;overflow-x:auto;font-size:14px;line-height:1.5}.code-example code{background:transparent;color:inherit;padding:0}.demo-note{background:#fff3cd;border:1px solid #ffc107;margin:24px 0}.demo-note ol{margin:8px 0;padding-left:24px}.checklist-table{width:100%;border-collapse:separate;border-spacing:0;margin:20px 0;font-size:14px;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px var(--shadow)}.checklist-table th{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:14px 16px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;letter-spacing:.5px}.checklist-table th:first-child{width:100px}.checklist-table th:nth-child(3),.checklist-table th:nth-child(4){width:120px;text-align:center}.checklist-table td{padding:12px 16px;border-bottom:1px solid var(--border);background:#fff}.checklist-table tr:last-child td{border-bottom:none}.checklist-table tr:nth-child(2n) td{background:#f8f9fa}.checklist-table tr:hover td{background:#e8f4fd;transition:background .2s ease}.checklist-table td:first-child{font-weight:600;white-space:nowrap}.checklist-table td:nth-child(3),.checklist-table td:nth-child(4){text-align:center}.checklist-table td:first-child{position:relative;padding-left:36px}.checklist-table td:first-child:before{content:"";position:absolute;left:16px;top:50%;transform:translateY(-50%);width:8px;height:8px;border-radius:50%}.checklist-table tr:nth-child(2) td:first-child:before,.checklist-table tr:nth-child(3) td:first-child:before{background:#dc3545;box-shadow:0 0 8px #dc354580}.checklist-table tr:nth-child(4) td:first-child:before,.checklist-table tr:nth-child(5) td:first-child:before{background:#ffc107;box-shadow:0 0 8px #ffc10780}.checklist-table tr:nth-child(6) td:first-child:before,.checklist-table tr:nth-child(7) td:first-child:before{background:#28a745;box-shadow:0 0 8px #28a74580}.accordion{border:1px solid var(--border);border-radius:8px;margin:16px 0;background:var(--card);overflow:visible;position:relative;z-index:100}.accordion summary{padding:16px 20px;cursor:pointer;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:1px solid var(--border);list-style:none;position:relative;z-index:101;font-weight:600;font-size:18px;transition:all .3s ease;margin:0;border-radius:8px 8px 0 0}.accordion summary::-webkit-details-marker{display:none}.accordion summary{pointer-events:auto;-webkit-user-select:none;user-select:none}.accordion[open] .accordion-content{pointer-events:auto}.accordion summary:after{content:"â–¼";position:absolute;right:20px;top:50%;transform:translateY(-50%) rotate(0);transition:transform .3s ease;color:var(--accent);font-size:14px}.accordion[open] summary{position:sticky;top:0;z-index:102;border-bottom:1px solid var(--border)}.accordion[open] summary:after{transform:translateY(-50%) rotate(180deg)}.accordion summary:hover{background:linear-gradient(135deg,#e9ecef,#dee2e6);color:var(--accent)}.accordion-content{padding:20px;border-top:none;animation:slideDown .3s ease;position:relative;z-index:99;margin-top:-1px;background:var(--card)}@keyframes slideDown{0%{opacity:0;max-height:0;padding-top:0;padding-bottom:0}to{opacity:1;max-height:1000px;padding-top:20px;padding-bottom:20px}}.accordion:not([open]) .accordion-content{display:none}@media (max-width:980px){.grid{grid-template-columns:1fr}.tabs{flex-direction:column}.tab-button{width:100%}.checklist-table{font-size:12px}.checklist-table th,.checklist-table td{padding:8px}.accordion summary{padding:12px 16px}.accordion-content{padding:16px}}
